

test_that("Preflow works", {
  s <- c(0,0,1,1,2,2,3,3,4,4)
  t <- c(1,2,2,3,1,4,2,5,3,5)
  cap <- c(16,13,10,124,14,9,20,7,4,0)
  out <- PreflowRunner(s,t,cap,0,5,6)
  expect_is(out[[3]],"integer")
  expect_is(out[[2]],"integer")
  expect_is(out[[1]], "integer")
  out <- MaxFlow(s,t,cap,0,5,6, "Preflow")
  expect_is(out[[3]],"integer")
  expect_is(out[[2]],"integer")
  expect_is(out[[1]], "integer")
  expect_error(MaxFlow(s,t,cap,0,5,6,"abc"), "Invalid")
})

test_that("Edmonds-Karp works", {
  s <- c(0,0,1,1,2,2,3,3,4,4)
  t <- c(1,2,2,3,1,4,2,5,3,5)
  cap <- c(16,13,10,124,14,9,20,7,4,0)
  out <- EdmondsKarpRunner(s,t,cap,0,5,6)
  expect_is(out[[3]],"integer")
  expect_is(out[[2]], "integer")
  expect_is(out[[1]], "integer")
  out <- MaxFlow(s,t,cap,0,5,6,"EdmondsKarp")
  expect_is(out[[3]],"integer")
  expect_is(out[[2]], "integer")
  expect_is(out[[1]], "integer")
  expect_error(MaxFlow(s,t,cap,0,5,6,"abc"), "Invalid")
})

test_that("Circulation works", {
  s <- c(0,0,1,1,2,2,3,3,4,4)
  t <- c(1,2,2,3,1,4,2,5,3,5)
  lower <- c(0,0,0,0,0,0,0,0,0,0)
  upper <- c(16,13,10,124,14,9,20,7,4,0)
  supplies <- c(1,2,3,4,5,6)
  out <- NetworkCirculation(s,t,lower, upper, supplies, 6, "Circulation")
  expect_is(out[[1]], "integer")
  expect_is(out[[2]], "integer")
  expect_error(NetworkCirculation(s,t,lower, upper, supplies, 6, "abc"), "Invalid")
})